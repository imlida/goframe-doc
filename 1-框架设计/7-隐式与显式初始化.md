---
title: '隐式与显式初始化'
sidebar_position: 7
---

我们知道在程序启动时会需要执行一些"初始化"的逻辑操作，例如： `Server` 配置、各种数据库（ `MySQL`、 `Redis`、 `Kafka` 等）配置、业务对象配置等等。绝大多数场景下，我们有两种初始化方式：隐式初始化和显式初始化。

## 一、隐式初始化

特别注意：在 `Golang v1.21` 版本后， `init` 的初始化执行顺序发生了变化，并且可能会引起依赖 `init` 来执行初始化逻辑的包的问题。因此，不建议在 `init` 中执行 **复杂的初始化逻辑**， **建议是通过显式调用方式来实现模块复杂的初始化逻辑**。

隐式初始化一般通过包初始化方法 `init` 执行初始化。需要注意的是，如果初始化逻辑存在错误的可能，由于 `init` 方法的错误无法被上层捕获，初始化出错时往往直接终止程序启动。例如：

![](/markdown/9190e5a8e2acf34a70442c6814a52327.png)

隐式初始化出错时往往直接终止程序启动

隐式初始化的好处是不需要手动调用初始化方法，对于开发者隐藏了初始化细节，因此开发者没有心智负担。但是缺点也同样如此，开发者不知道初始化细节，一旦出现错误时，很难快速定位错误原因。因此使用隐式初始化时，往往要求在初始化出错时将详细的错误以及堆栈信息打印出来便于错误定位。

`GoFrame` 框架的很多模块都采用了隐式初始化，隐藏模块的初始化细节，减少开发者的心智负担。例如：

![](/markdown/d019031d40a93f6318a933271d63c503.png)

`GoFrame` 中的模块普遍存在隐式初始化设计

![](/markdown/b0b839a86595ee57f2c5a1b39c559df0.png)

使用 `GoFrame` 框架的 `main` 包隐式 `imports`

关于包 `init` 方法的初始化流程：

![](/markdown/40b3b7c2b75dcb36be348c840ca0eb3e.png)

## 二、显式初始化

显式初始化要求开发在程序启动时，如在 `main` 或者 `boot` 模块中，调用特定的方法来执行初始化操作。一般来说，基础组件的初始化往往采用隐式初始化多一些，因为对于使用者来讲并不关心底层基础模块的初始化逻辑，而业务模块的初始化大多数会采用显式初始化。例如：

![](/markdown/0124c249f03cd1f9fd78fe0970ffbda6.png)在 `boot` 包中按照顺序执行显式初始化

![](/markdown/8417caae0e203d44d43c6bca369b3023.png)在 `main` 包调用 `boot.Boot()` 方法执行初始化

## 三、如何选择

在业务场景下，非特殊必要，我们建议大家采用 **显式初始化** 的方式，以保证更好的可维护性。